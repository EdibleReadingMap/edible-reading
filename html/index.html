<!DOCTYPE html>
<html>
  <head>
    <!-- prevent iPhone user from using browser zoom -->
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Edible Reading Map</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      .gm-style-iw {
        min-height: 75px;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=true&v=3.exp"></script>
    <script>

var lat = 51.4542,
    lng = -0.9731;

function success(position) {
  var latmin = 51.411168,
      latmax = 51.539263,
      lngmin = -1.136984,
      lngmax = -0.7519424,
      mylat  = position.coords.latitude,
      mylng  = position.coords.longitude;

  if (mylat > latmin && mylat < latmax) {
    lat = mylat;
  }
  if (mylng > lngmin && mylng < lngmax) {
    lng = mylng;
  }
}

function initialize() {
  navigator.geolocation.getCurrentPosition(success);

  var reading = new google.maps.LatLng(lat, lng);
  var mapOptions = {
    zoom: 15,
    center: reading,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }

  var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

  var ctaLayer = new google.maps.KmlLayer({
    url: 'https://raw.githubusercontent.com/ollyg/edible-reading/master/html/edread.kml',
    preserveViewport: true // preserve our mapOptions center
  });
  ctaLayer.setMap(map);
}

google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>
  <body>
    <div id="map-canvas"></div>
  </body>
</html>

<!--
lat: 51.411168 <-> 51.539263
long: -1.136984 <-> -0.7519424
midlat: 51.4752155, mindlong: -0.9444632
reading lat: 51.4542, long: -0.9731
-->
